(function(D,J){function K(a,b){function c(){}c.prototype=a;var d=new c,k;for(k in b)d[k]=b[k];b.toString!==Object.prototype.toString&&(d.toString=b.toString);return d}function f(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=O++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c);return c}var G=function(){this.bufferList=new t;var a=this.types=new t;
null!=e.mp3?a.setReserved("mp3","audio/mpeg"):a.h.mp3="audio/mpeg";a=this.types;null!=e.ogg?a.setReserved("ogg","audio/ogg"):a.h.ogg="audio/ogg";a=this.types;null!=e.wav?a.setReserved("wav","audio/wav"):a.h.wav="audio/wav";a=this.types;null!=e.aac?a.setReserved("aac","audio/aac"):a.h.aac="audio/aac";a=this.types;null!=e.m4a?a.setReserved("m4a","audio/x-m4a"):a.h.m4a="audio/x-m4a"};G.__name__=!0;G.prototype={checkWebAudioAPISupport:function(){return null==h.field(window,"AudioContext")?null!=h.field(window,
"webkitAudioContext"):!0},unlockAudio:function(){if(null!=this.audioContext){var a=this.audioContext.createBuffer(1,1,d.preferredSampleRate),b=this.audioContext.createBufferSource();b.buffer=a;b.connect(this.audioContext.destination);null!=h.field(b,"start")?b.start(0):b.noteOn(0);null!=b.onended?b.onended=f(this,this._unlockCallback):v.delay(f(this,this._unlockCallback),1)}else a=window.document.createElement("audio"),b=window.document.createElement("source"),b.src="data:audio/wave;base64,UklGRjIAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAAABmYWN0BAAAAAAAAABkYXRhAAAAAA==",
a.appendChild(b),window.document.appendChild(a),a.play(),null!=d.__touchUnlockCallback&&d.__touchUnlockCallback(),d.dom.ontouchend=null},_unlockCallback:function(){null!=d.__touchUnlockCallback&&d.__touchUnlockCallback();d.dom.ontouchend=null},createAudioContext:function(){if(null==this.audioContext)try{null!=h.field(window,"AudioContext")?this.audioContext=new AudioContext:null!=h.field(window,"webkitAudioContext")&&(this.audioContext=new webkitAudioContext),this.masterGainNode=this.createGain()}catch(a){this.audioContext=
null}return this.audioContext},createGain:function(){if(null!=(w=this.audioContext,f(w,w.createGain)))return this.audioContext.createGain();var a=this.audioContext;return h.field(this.audioContext,"createGainNode").apply(a,[])},destroy:function(){null!=this.audioContext&&null!=this.audioContext.close&&""!=this.audioContext.close&&this.audioContext.close();this.types=this.bufferList=this.audioContext=null},__class__:G};var x=function(a,b){this._b64=new l("(^data:audio).*(;base64,)","i");null!=a&&""!=
a&&null!=d.audioManager&&(this.isSpriteSound=!1,this.url=a,this._muted=this._isPlaying=this._isLoaded=!1,this._duration=0,this._options=p.setDefaultOptions(b),this.rate=this._options.playbackRate)};x.__name__=!0;x.prototype={isReady:function(){return this._isLoaded},__class__:x};var l=function(a,b){this.r=new RegExp(a,b.split("u").join(""))};l.__name__=!0;l.prototype={match:function(a){this.r.global&&(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m},matched:function(a){if(null!=
this.r.m&&0<=a&&a<this.r.m.length)return this.r.m[a];throw new q("EReg::matched");},__class__:l};var y=function(){};y.__name__=!0;y.prototype={__class__:y};var B=function(a,b,c){x.call(this,a,b);this._snd=d.dom.createElement("audio");null==c?this._addSource(a):this._snd.appendChild(c);this._options.preload&&this.load();this._b64.match(a)};B.__name__=!0;B.__interfaces__=[y];B.__super__=x;B.prototype=K(x.prototype,{load:function(a){var b=this;this._isLoaded||(this._snd.autoplay=this._options.autoplay,
this._snd.loop=this._options.loop,this._snd.volume=this._options.volume,this._snd.playbackRate=this.rate,null!=a&&(this._options.onload=a),this._snd.preload=this._options.preload?"auto":"metadata",null!=this._options.onload&&(this._isLoaded=!0,this._snd.onloadeddata=function(){b._options.onload(b)}),this._snd.onplaying=function(){b._isPlaying=!0},this._snd.onended=function(){b._isPlaying=!1;if(null!=b._options.onend)b._options.onend(b)},null!=this._options.onerror&&(this._snd.onerror=function(){b._options.onerror(b)}),
this._snd.load());return this},getDuration:function(){return this._isLoaded?this._duration=this._snd.duration:0},_addSource:function(a){this.source=d.dom.createElement("source");this.source.src=a;var b=d.audioManager.types,c=this._getExt(a);null!=(null!=e[c]?b.getReserved(c):b.h[c])&&(b=d.audioManager.types,a=this._getExt(a),a=null!=e[a]?b.getReserved(a):b.h[a],this.source.type=a);this._snd.appendChild(this.source);return this.source},_getExt:function(a){return a.split(".").pop()},setVolume:function(a,
b){0<=a&&1>=a&&(this._options.volume=a);this._isLoaded&&(this._snd.volume=this._options.volume)},getVolume:function(a){return this._options.volume},mute:function(a,b){this._isLoaded&&(this._snd.muted=a,p.isiOS()&&(a&&this.isPlaying()?(this._muted=!0,this._snd.pause()):this._muted&&(this._muted=!1,this._snd.play())))},toggleMute:function(a){this.mute(!this._muted)},play:function(a,b){var c=this;this.spriteName=a;if(!this._isLoaded||null==this._snd)return-1;if(this._isPlaying)if(this._options.autostop)this.stop(this.spriteName);
else{var d=g.__cast(this._snd.cloneNode(!0),HTMLAudioElement);v.delay(f(d,d.play),100)}if(this._muted)return-1;this.isSpriteSound&&null!=b&&(this._snd.currentTime=null==this._pauseTime?b.start:this._pauseTime,null!=this._tmr&&this._tmr.stop(),this._tmr=v.delay(function(){null!=b.loop&&b.loop?c.play(c.spriteName,b):c.stop(c.spriteName)},Math.ceil(1E3*b.duration)));v.delay((w=this._snd,f(w,w.play)),100);this._pauseTime=null;return 0},togglePlay:function(a){this._isPlaying?this.pause():this.play()},
isPlaying:function(a){return this._isPlaying},loop:function(a){this._isLoaded&&null!=this._snd&&(this._snd.loop=a)},autoStop:function(a){this._options.autostop=a},stop:function(a){this._isLoaded&&null!=this._snd&&(this._snd.currentTime=0,this._snd.pause(),this._isPlaying=!1,null!=this._tmr&&this._tmr.stop())},pause:function(a){this._isLoaded&&null!=this._snd&&(this._snd.pause(),this._pauseTime=this._snd.currentTime,this._isPlaying=!1,null!=this._tmr&&this._tmr.stop())},playbackRate:function(a,b){return null==
a?this.rate:this.rate=this._snd.playbackRate=a},setTime:function(a){!this._isLoaded||null==this._snd||a>this._snd.duration||(this._snd.currentTime=a)},getTime:function(){return null!=this._snd&&this._isLoaded&&this._isPlaying?this._snd.currentTime:0},onEnd:function(a,b){this._options.onend=a;return this},onLoad:function(a){this._options.onload=a;return this},onError:function(a){this._options.onerror=a;return this},destroy:function(){null!=this._snd&&(this._snd.pause(),this._snd.removeChild(this.source),
this._snd=this.source=null);this._isPlaying=!1},__class__:B});var E=function(){};E.__name__=!0;E.cca=function(a,b){var c=a.charCodeAt(b);return c!=c?void 0:c};Math.__name__=!0;var h=function(){};h.__name__=!0;h.field=function(a,b){try{return a[b]}catch(c){return null}};h.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty,d;for(d in a)"__id__"!=d&&"hx__closures__"!=d&&c.call(a,d)&&b.push(d)}return b};var z=function(){};z.__name__=!0;z.string=function(a){return g.__string_rec(a,
"")};z.parseInt=function(a){var b=parseInt(a,10);0!=b||120!=E.cca(a,1)&&88!=E.cca(a,1)||(b=parseInt(a));return isNaN(b)?null:b};var d=D.Waud=function(){};d.__name__=!0;d.init=function(a){null==d.__audioElement&&(null==a&&(a=window.document),d.dom=a,d.__audioElement=d.dom.createElement("audio"),null==d.audioManager&&(d.audioManager=new G),d.isWebAudioSupported=d.audioManager.checkWebAudioAPISupport(),d.isHTML5AudioSupported=null!=h.field(window,"Audio"),d.isWebAudioSupported&&(d.audioContext=d.audioManager.createAudioContext()),
d.sounds=new t,d._volume=1,a=d.isWebAudioSupported?"Web Audio":"HTML5 Audio",1<window.navigator.userAgent.toLowerCase().indexOf("chrome")?window.console.log.apply(window.console,["\n %c %c %c WAUD%c.%cJS%c v"+d.version+" - "+a+" %c  %c http://www.waudjs.com %c %c %c \ud83d\udce2 \n\n","background: #32BEA6; padding:5px 0;","background: #32BEA6; padding:5px 0;","color: #E70000; background: #29162B; padding:5px 0;","color: #F3B607; background: #29162B; padding:5px 0;","color: #32BEA6; background: #29162B; padding:5px 0;",
"color: #999999; background: #29162B; padding:5px 0;","background: #32BEA6; padding:5px 0;","background: #B8FCEF; padding:5px 0;","background: #32BEA6; padding:5px 0;","color: #E70000; background: #32BEA6; padding:5px 0;","color: #FF2424; background: #FFFFFF; padding:5px 0;"]):window.console.log("WAUD.JS v"+d.version+" - "+a+" - http://www.waudjs.com"))};d._sayHello=function(){var a=d.isWebAudioSupported?"Web Audio":"HTML5 Audio";1<window.navigator.userAgent.toLowerCase().indexOf("chrome")?window.console.log.apply(window.console,
["\n %c %c %c WAUD%c.%cJS%c v"+d.version+" - "+a+" %c  %c http://www.waudjs.com %c %c %c \ud83d\udce2 \n\n","background: #32BEA6; padding:5px 0;","background: #32BEA6; padding:5px 0;","color: #E70000; background: #29162B; padding:5px 0;","color: #F3B607; background: #29162B; padding:5px 0;","color: #32BEA6; background: #29162B; padding:5px 0;","color: #999999; background: #29162B; padding:5px 0;","background: #32BEA6; padding:5px 0;","background: #B8FCEF; padding:5px 0;","background: #32BEA6; padding:5px 0;",
"color: #E70000; background: #32BEA6; padding:5px 0;","color: #FF2424; background: #FFFFFF; padding:5px 0;"]):window.console.log("WAUD.JS v"+d.version+" - "+a+" - http://www.waudjs.com")};d.autoMute=function(){d._focusManager=new r;d._focusManager.focus=function(){d.mute(!1)};d._focusManager.blur=function(){d.mute(!0)}};d.enableTouchUnlock=function(a){d.__touchUnlockCallback=a;d.dom.ontouchend=(w=d.audioManager,f(w,w.unlockAudio))};d.setVolume=function(a){if(("number"==typeof a&&(a|0)===a||"number"==
typeof a)&&0<=a&&1>=a){if(d._volume=a,null!=d.sounds)for(var b=d.sounds,b=new m(b,b.arrayKeys());b.hasNext();)b.next().setVolume(a)}else window.console.warn("Volume should be a number between 0 and 1. Received: "+a)};d.getVolume=function(){return d._volume};d.mute=function(a){null==a&&(a=!0);d.isMuted=a;if(null!=d.sounds)for(var b=d.sounds,b=new m(b,b.arrayKeys());b.hasNext();)b.next().mute(a)};d.playbackRate=function(a){if(null==a)return d._playbackRate;if(null!=d.sounds)for(var b=d.sounds,b=new m(b,
b.arrayKeys());b.hasNext();)b.next().playbackRate(a);return d._playbackRate=a};d.stop=function(){if(null!=d.sounds)for(var a=d.sounds,a=new m(a,a.arrayKeys());a.hasNext();)a.next().stop()};d.pause=function(){if(null!=d.sounds)for(var a=d.sounds,a=new m(a,a.arrayKeys());a.hasNext();)a.next().pause()};d.getFormatSupportString=function(){var a="OGG: "+d.__audioElement.canPlayType('audio/ogg; codecs="vorbis"'),a=a+(", WAV: "+d.__audioElement.canPlayType('audio/wav; codecs="1"')),a=a+(", MP3: "+d.__audioElement.canPlayType("audio/mpeg;")),
a=a+(", AAC: "+d.__audioElement.canPlayType("audio/aac;"));return a+=", M4A: "+d.__audioElement.canPlayType("audio/x-m4a;")};d.isSupported=function(){if(null==d.isWebAudioSupported||null==d.isHTML5AudioSupported)d.isWebAudioSupported=d.audioManager.checkWebAudioAPISupport(),d.isHTML5AudioSupported=null!=h.field(window,"Audio");return d.isWebAudioSupported?!0:d.isHTML5AudioSupported};d.isOGGSupported=function(){var a=d.__audioElement.canPlayType('audio/ogg; codecs="vorbis"');return d.isHTML5AudioSupported&&
null!=a?"probably"!=a?"maybe"==a:!0:!1};d.isWAVSupported=function(){var a=d.__audioElement.canPlayType('audio/wav; codecs="1"');return d.isHTML5AudioSupported&&null!=a?"probably"!=a?"maybe"==a:!0:!1};d.isMP3Supported=function(){var a=d.__audioElement.canPlayType("audio/mpeg;");return d.isHTML5AudioSupported&&null!=a?"probably"!=a?"maybe"==a:!0:!1};d.isAACSupported=function(){var a=d.__audioElement.canPlayType("audio/aac;");return d.isHTML5AudioSupported&&null!=a?"probably"!=a?"maybe"==a:!0:!1};d.isM4ASupported=
function(){var a=d.__audioElement.canPlayType("audio/x-m4a;");return d.isHTML5AudioSupported&&null!=a?"probably"!=a?"maybe"==a:!0:!1};d.getSampleRate=function(){return null!=d.audioContext?d.audioContext.sampleRate:0};d.destroy=function(){if(null!=d.sounds)for(var a=d.sounds,a=new m(a,a.arrayKeys());a.hasNext();)a.next().destroy();d.sounds=null;null!=d.audioManager&&d.audioManager.destroy();d.audioManager=null;d.audioContext=null;d.__audioElement=null;null!=d._focusManager&&(d._focusManager.clearEvents(),
d._focusManager.blur=null,d._focusManager.focus=null,d._focusManager=null)};var H=D.WaudBase64Pack=function(a,b,c,n,k,e){null==e&&(e=!1);null!=d.audioManager&&(this._sequentialLoad=e,0<a.indexOf(".json")&&(this.progress=0,this._options=p.setDefaultOptions(k),this._loadCount=this._soundCount=this._totalSize=0,this._onLoaded=b,this._onProgress=c,this._onError=n,this._sounds=new t,this._loadBase64Json(a)))};H.__name__=!0;H.prototype={_loadBase64Json:function(a){var b=this,c=new l('"meta":.[0-9]*,[0-9]*.',
"i"),d=new XMLHttpRequest;d.open("GET",a,!0);null!=this._onProgress&&(d.onprogress=function(a){if(c.match(d.responseText)&&0==b._totalSize){var e=JSON.parse("{"+c.matched(0)+"}");b._totalSize=e.meta[1]}b.progress=a.lengthComputable?a.loaded/a.total:a.loaded/b._totalSize;1<b.progress&&(b.progress=1);b._onProgress(.8*b.progress)});d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){var a=JSON.parse(d.responseText);b._soundsToLoad=new t;b._soundIds=[];for(var c=0,f=h.fields(a);c<f.length;){var g=
f[c];++c;if("meta"!=g)if(a instanceof Array&&null==a.__enum__){b._soundIds.push(h.field(a,g).name);var m=b._soundsToLoad,l=h.field(a,g).name,g="data:"+z.string(h.field(a,g).mime)+";base64,"+z.string(h.field(a,g).data);null!=e[l]?m.setReserved(l,g):m.h[l]=g}else b._soundIds.push(g),m=b._soundsToLoad,l=h.field(a,g),null!=e[g]?m.setReserved(g,l):m.h[g]=l}b._soundCount=b._soundIds.length;if(b._sequentialLoad)a=b._soundIds.shift(),b._createSound(a);else for(;0<b._soundIds.length;)a=b._soundIds.shift(),
b._createSound(a)}};d.send(null)},_createSound:function(a){var b=this,c=this._soundsToLoad;new F(null!=e[a]?c.getReserved(a):c.h[a],{onload:function(c){var k=b._sounds;null!=e[a]?k.setReserved(a,c):k.h[a]=c;k=d.sounds;null!=e[a]?k.setReserved(a,c):k.h[a]=c;if(null!=b._options.onload)b._options.onload(c);b._checkProgress()},onerror:function(c){var d=b._sounds;null!=e[a]?d.setReserved(a,null):d.h[a]=null;if(null!=b._options.onerror)b._options.onerror(c);b._checkProgress()&&null!=b._onError&&b._onError()},
autoplay:this._options.autoplay,autostop:this._options.autostop,loop:this._options.loop,onend:this._options.onend,playbackRate:this._options.playbackRate,preload:this._options.preload,volume:this._options.volume,webaudio:this._options.webaudio})},_checkProgress:function(){this._loadCount++;null!=this._onProgress&&this._onProgress(.8+this._loadCount/this._soundCount*.19999999999999996);if(this._loadCount==this._soundCount)return this._soundsToLoad=null,null!=this._onLoaded&&this._onLoaded(this._sounds),
!0;this._sequentialLoad&&this._createSound(this._soundIds.shift());return!1},__class__:H};var r=D.WaudFocusManager=function(){var a=this;this._currentState=this._visibilityChange=this._hidden="";null!=h.field(window.document,"hidden")?(this._hidden="hidden",this._visibilityChange="visibilitychange"):null!=h.field(window.document,"mozHidden")?(this._hidden="mozHidden",this._visibilityChange="mozvisibilitychange"):null!=h.field(window.document,"msHidden")?(this._hidden="msHidden",this._visibilityChange=
"msvisibilitychange"):null!=h.field(window.document,"webkitHidden")&&(this._hidden="webkitHidden",this._visibilityChange="webkitvisibilitychange");null!=h.field(window,"addEventListener")?(window.addEventListener("focus",f(this,this._focus)),window.addEventListener("blur",f(this,this._blur)),window.addEventListener("pageshow",f(this,this._focus)),window.addEventListener("pagehide",f(this,this._blur)),document.addEventListener(this._visibilityChange,f(this,this._handleVisibilityChange))):null!=h.field(window,
"attachEvent")?(window.attachEvent("onfocus",f(this,this._focus)),window.attachEvent("onblur",f(this,this._blur)),window.attachEvent("pageshow",f(this,this._focus)),window.attachEvent("pagehide",f(this,this._blur)),document.attachEvent(this._visibilityChange,f(this,this._handleVisibilityChange))):window.onload=function(){window.onfocus=f(a,a._focus);window.onblur=f(a,a._blur);window.onpageshow=f(a,a._focus);window.onpagehide=f(a,a._blur)}};r.__name__=!0;r.prototype={_handleVisibilityChange:function(){null!=
h.field(window.document,this._hidden)&&h.field(window.document,this._hidden)&&null!=this.blur?this.blur():null!=this.focus&&this.focus()},_focus:function(){"focus"!=this._currentState&&null!=this.focus&&this.focus();this._currentState="focus"},_blur:function(){"blur"!=this._currentState&&null!=this.blur&&this.blur();this._currentState="blur"},clearEvents:function(){null!=h.field(window,"removeEventListener")?(window.removeEventListener("focus",f(this,this._focus)),window.removeEventListener("blur",
f(this,this._blur)),window.removeEventListener("pageshow",f(this,this._focus)),window.removeEventListener("pagehide",f(this,this._blur)),window.removeEventListener(this._visibilityChange,f(this,this._handleVisibilityChange))):null!=h.field(window,"removeEvent")?(window.removeEvent("onfocus",f(this,this._focus)),window.removeEvent("onblur",f(this,this._blur)),window.removeEvent("pageshow",f(this,this._focus)),window.removeEvent("pagehide",f(this,this._blur)),window.removeEvent(this._visibilityChange,
f(this,this._handleVisibilityChange))):(window.onfocus=null,window.onblur=null,window.onpageshow=null,window.onpagehide=null)},__class__:r};var F=D.WaudSound=function(a,b){if(null!=d.audioManager)if(this.rate=1,this._options=b,0<a.indexOf(".json")?(this.isSpriteSound=!0,this._spriteDuration=0,this._spriteSounds=new t,this._spriteSoundEndCallbacks=new t,this._loadSpriteJson(a)):(this.isSpriteSound=!1,this._init(a)),(new l("(^data:audio).*(;base64,)","i")).match(a)){var c=d.sounds,n="snd"+(new Date).getTime();
null!=e[n]?c.setReserved(n,this):c.h[n]=this}else c=d.sounds,null!=e[a]?c.setReserved(a,this):c.h[a]=this};F.__name__=!0;F.__interfaces__=[y];F.prototype={_loadSpriteJson:function(a){var b=this,c=new XMLHttpRequest;c.open("GET",a,!0);c.onreadystatechange=function(){if(4==c.readyState&&200==c.status){b._spriteData=JSON.parse(c.responseText);var d=b._spriteData.src;if(-1<a.indexOf("/"))var e=a.lastIndexOf("/")+1,d=a.substring(0,e)+d;b._init(d)}};c.send(null)},_init:function(a){this.url=a;if(d.isWebAudioSupported&&
d.useWebAudio&&(null==this._options||null==this._options.webaudio||this._options.webaudio))this.isSpriteSound?this._loadSpriteSound(this.url):this._snd=new C(this.url,this._options);else if(d.isHTML5AudioSupported)if(null!=this._spriteData&&null!=this._spriteData.sprite){a=0;for(var b=this._spriteData.sprite;a<b.length;){var c=b[a];++a;var n=new B(this.url,this._options);n.isSpriteSound=!0;var c=c.name,k=this._spriteSounds;null!=e[c]?k.setReserved(c,n):k.h[c]=n}}else this._snd=new B(this.url,this._options)},
getDuration:function(){return this.isSpriteSound?this._spriteDuration:null==this._snd?0:this._snd.getDuration()},setVolume:function(a,b){if("number"==typeof a&&(a|0)===a||"number"==typeof a)if(this.isSpriteSound){var c;null!=b?(c=this._spriteSounds,c=null!=(null!=e[b]?c.getReserved(b):c.h[b])):c=!1;c&&(c=this._spriteSounds,(null!=e[b]?c.getReserved(b):c.h[b]).setVolume(a))}else null!=this._snd&&this._snd.setVolume(a);else window.console.warn("Volume should be a number between 0 and 1. Received: "+
a)},getVolume:function(a){if(this.isSpriteSound){var b;null!=a?(b=this._spriteSounds,b=null!=(null!=e[a]?b.getReserved(a):b.h[a])):b=!1;return b?(b=this._spriteSounds,(null!=e[a]?b.getReserved(a):b.h[a]).getVolume()):0}return null==this._snd?0:this._snd.getVolume()},mute:function(a,b){if(this.isSpriteSound){var c;null!=b?(c=this._spriteSounds,c=null!=(null!=e[b]?c.getReserved(b):c.h[b])):c=!1;if(c)c=this._spriteSounds,(null!=e[b]?c.getReserved(b):c.h[b]).mute(a);else for(c=this._spriteSounds,c=new m(c,
c.arrayKeys());c.hasNext();)c.next().mute(a)}else null!=this._snd&&this._snd.mute(a)},toggleMute:function(a){if(this.isSpriteSound){var b;null!=a?(b=this._spriteSounds,b=null!=(null!=e[a]?b.getReserved(a):b.h[a])):b=!1;if(b)b=this._spriteSounds,(null!=e[a]?b.getReserved(a):b.h[a]).toggleMute();else for(a=this._spriteSounds,a=new m(a,a.arrayKeys());a.hasNext();)a.next().toggleMute()}else null!=this._snd&&this._snd.toggleMute()},load:function(a){if(null==this._snd||this.isSpriteSound)return null;this._snd.load(a);
return this},isReady:function(){if(this.isSpriteSound)for(var a=this._spriteSounds,a=new m(a,a.arrayKeys());a.hasNext();)return a.next().isReady();return this._snd.isReady()},play:function(a,b){if(this.isSpriteSound)if(null!=a){for(var c=0,d=this._spriteData.sprite;c<d.length;){var k=d[c];++c;if(k.name==a){b=k;break}}if(null==b)return null;c=this._spriteSounds;if(null!=(null!=e[a]?c.getReserved(a):c.h[a]))return c=this._spriteSounds,(null!=e[a]?c.getReserved(a):c.h[a]).play(a,b)}else return null;
return null==this._snd?null:this._snd.play(a,b)},togglePlay:function(a){if(this.isSpriteSound){var b;null!=a?(b=this._spriteSounds,b=null!=(null!=e[a]?b.getReserved(a):b.h[a])):b=!1;b&&(b=this._spriteSounds,(null!=e[a]?b.getReserved(a):b.h[a]).togglePlay())}else null!=this._snd&&this._snd.togglePlay()},isPlaying:function(a){if(this.isSpriteSound){var b;null!=a?(b=this._spriteSounds,b=null!=(null!=e[a]?b.getReserved(a):b.h[a])):b=!1;return b?(b=this._spriteSounds,(null!=e[a]?b.getReserved(a):b.h[a]).isPlaying()):
!1}return null==this._snd?!1:this._snd.isPlaying()},loop:function(a){null==this._snd||this.isSpriteSound||this._snd.loop(a)},autoStop:function(a){null!=this._snd&&this._snd.autoStop(a)},stop:function(a){if(this.isSpriteSound){var b;null!=a?(b=this._spriteSounds,b=null!=(null!=e[a]?b.getReserved(a):b.h[a])):b=!1;if(b)b=this._spriteSounds,(null!=e[a]?b.getReserved(a):b.h[a]).stop();else for(a=this._spriteSounds,a=new m(a,a.arrayKeys());a.hasNext();)a.next().stop()}else null!=this._snd&&this._snd.stop()},
pause:function(a){if(this.isSpriteSound){var b;null!=a?(b=this._spriteSounds,b=null!=(null!=e[a]?b.getReserved(a):b.h[a])):b=!1;if(b)b=this._spriteSounds,(null!=e[a]?b.getReserved(a):b.h[a]).pause();else for(a=this._spriteSounds,a=new m(a,a.arrayKeys());a.hasNext();)a.next().pause()}else null!=this._snd&&this._snd.pause()},playbackRate:function(a,b){if(null!=a){if(this.isSpriteSound){var c;null!=b?(c=this._spriteSounds,c=null!=(null!=e[b]?c.getReserved(b):c.h[b])):c=!1;if(c)c=this._spriteSounds,(null!=
e[b]?c.getReserved(b):c.h[b]).playbackRate(a);else for(c=this._spriteSounds,c=new m(c,c.arrayKeys());c.hasNext();)c.next().playbackRate(a)}else null!=this._snd&&this._snd.playbackRate(a);return this.rate=a}return this.rate},setTime:function(a){null==this._snd||this.isSpriteSound||this._snd.setTime(a)},getTime:function(){return null==this._snd||this.isSpriteSound?0:this._snd.getTime()},onEnd:function(a,b){if(this.isSpriteSound){if(null!=b){var c=this._spriteSoundEndCallbacks;null!=e[b]?c.setReserved(b,
a):c.h[b]=a}return this}return null!=this._snd?(this._snd.onEnd(a),this):null},onLoad:function(a){if(null==this._snd||this.isSpriteSound)return null;this._snd.onLoad(a);return this},onError:function(a){if(null==this._snd||this.isSpriteSound)return null;this._snd.onError(a);return this},destroy:function(){if(this.isSpriteSound)for(var a=this._spriteSounds,a=new m(a,a.arrayKeys());a.hasNext();)a.next().destroy();else null!=this._snd&&(this._snd.destroy(),this._snd=null)},_loadSpriteSound:function(a){var b=
new XMLHttpRequest;b.open("GET",a,!0);b.responseType="arraybuffer";b.onload=f(this,this._onSpriteSoundLoaded);b.onerror=f(this,this._onSpriteSoundError);b.send()},_onSpriteSoundLoaded:function(a){d.audioManager.audioContext.decodeAudioData(a.target.response,f(this,this._decodeSuccess),f(this,this._onSpriteSoundError))},_onSpriteSoundError:function(){if(null!=this._options&&null!=this._options.onerror)this._options.onerror(this)},_decodeSuccess:function(a){if(null==a)this._onSpriteSoundError();else{var b=
this.url,c=d.audioManager.bufferList;null!=e[b]?c.setReserved(b,a):c.h[b]=a;this._spriteDuration=a.duration;if(null!=this._options&&null!=this._options.onload)this._options.onload(this);b=0;for(c=this._spriteData.sprite;b<c.length;){var n=c[b];++b;var k=new C(this.url,this._options,!0,a.duration);k.isSpriteSound=!0;var g=n.name,h=this._spriteSounds;null!=e[g]?h.setReserved(g,k):h.h[g]=k;k.onEnd(f(this,this._spriteOnEnd),n.name)}}},_spriteOnEnd:function(a){var b=a.spriteName,c=this._spriteSoundEndCallbacks;
null!=(null!=e[b]?c.getReserved(b):c.h[b])&&(b=a.spriteName,c=this._spriteSoundEndCallbacks,(null!=e[b]?c.getReserved(b):c.h[b])(a))},__class__:F};var p=D.WaudUtils=function(){};p.__name__=!0;p.isAndroid=function(a){null==a&&(a=window.navigator.userAgent);return(new l("Android","i")).match(a)};p.isiOS=function(a){null==a&&(a=window.navigator.userAgent);return(new l("(iPad|iPhone|iPod)","i")).match(a)};p.isWindowsPhone=function(a){null==a&&(a=window.navigator.userAgent);return(new l("(IEMobile|Windows Phone)",
"i")).match(a)};p.isFirefox=function(a){null==a&&(a=window.navigator.userAgent);return(new l("Firefox","i")).match(a)};p.isOpera=function(a){null==a&&(a=window.navigator.userAgent);return(new l("Opera","i")).match(a)?!0:null!=h.field(window,"opera")};p.isChrome=function(a){null==a&&(a=window.navigator.userAgent);return(new l("Chrome","i")).match(a)};p.isSafari=function(a){null==a&&(a=window.navigator.userAgent);return(new l("Safari","i")).match(a)};p.isMobile=function(a){null==a&&(a=window.navigator.userAgent);
return(new l("(iPad|iPhone|iPod|Android|webOS|BlackBerry|Windows Phone|IEMobile)","i")).match(a)};p.getiOSVersion=function(a){null==a&&(a=window.navigator.userAgent);var b=new l("[0-9_]+?[0-9_]+?[0-9_]+","i"),c=[];if(b.match(a)){a=b.matched(0).split("_");b=[];for(c=0;c<a.length;){var d=a[c];++c;b.push(z.parseInt(d))}c=b}return c};p.setDefaultOptions=function(a){null==a&&(a={});a.autoplay=null!=a.autoplay?a.autoplay:d.defaults.autoplay;a.autostop=null!=a.autostop?a.autostop:d.defaults.autostop;a.webaudio=
null!=a.webaudio?a.webaudio:d.defaults.webaudio;a.preload=null!=a.preload?a.preload:d.defaults.preload;a.loop=null!=a.loop?a.loop:d.defaults.loop;a.onload=null!=a.onload?a.onload:d.defaults.onload;a.onend=null!=a.onend?a.onend:d.defaults.onend;a.onerror=null!=a.onerror?a.onerror:d.defaults.onerror;if(null==a.volume||0>a.volume||1<a.volume)a.volume=d.defaults.volume;if(null==a.playbackRate||0>=a.playbackRate||4<=a.playbackRate)a.playbackRate=d.defaults.playbackRate;return a};var C=function(a,b,c,n){null==
n&&(n=0);null==c&&(c=!1);x.call(this,a,b);this._pauseTime=this._playStartTime=0;this._srcNodes=[];this._gainNodes=[];this._currentSoundProps=null;this._isLoaded=c;this._duration=n;this._manager=d.audioManager;this._b64.match(a)?(a=this._base64ToArrayBuffer(a),this._manager.audioContext.decodeAudioData(a,f(this,this._decodeSuccess),f(this,this._error))):this._options.preload&&!c&&this.load()};C.__name__=!0;C.__interfaces__=[y];C.__super__=x;C.prototype=K(x.prototype,{load:function(a){if(!this._isLoaded){var b=
new XMLHttpRequest;b.open("GET",this.url,!0);b.responseType="arraybuffer";b.onload=f(this,this._onSoundLoaded);b.onerror=f(this,this._error);b.send();null!=a&&(this._options.onload=a)}return this},_base64ToArrayBuffer:function(a){a=window.atob(a.split(",")[1]);for(var b=a.length,c=new L(new I(b)),d=0;d<b;){var e=d++;c[e]=E.cca(a,e)}return c.buffer},_onSoundLoaded:function(a){this._manager.audioContext.decodeAudioData(a.target.response,f(this,this._decodeSuccess),f(this,this._error))},_decodeAudio:function(a){this._manager.audioContext.decodeAudioData(a,
f(this,this._decodeSuccess),f(this,this._error))},_error:function(){if(null!=this._options.onerror)this._options.onerror(this)},_decodeSuccess:function(a){if(null==a)this._error();else{var b=this.url,c=this._manager.bufferList;null!=e[b]?c.setReserved(b,a):c.h[b]=a;this._isLoaded=!0;this._duration=a.duration;if(null!=this._options.onload)this._options.onload(this);this._options.autoplay&&this.play()}},_makeSource:function(a){var b=this._manager.audioContext.createBufferSource();b.buffer=a;this._gainNode=
this._manager.createGain();b.connect(this._gainNode);b.playbackRate.value=this.rate;this._gainNode.connect(this._manager.masterGainNode);this._manager.masterGainNode.connect(this._manager.audioContext.destination);this._srcNodes.push(b);this._gainNodes.push(this._gainNode);this._gainNode.gain.value=this._muted?0:this._options.volume;return b},getDuration:function(){return this._isLoaded?this._duration:0},play:function(a,b){var c=this;this.spriteName=a;this._isPlaying&&this._options.autostop&&this.stop(this.spriteName);
if(!this._isLoaded)return-1;var d=0,f=-1;this.isSpriteSound&&null!=b&&(this._currentSoundProps=b,d=b.start+this._pauseTime,f=b.duration);var g;if(null!=this._manager.bufferList){g=this.url;var h=this._manager.bufferList;g=null!=e[g]?h.getReserved(g):h.h[g]}else g=null;null!=g&&(this.source=this._makeSource(g),0<=d&&-1<f?this._start(0,d,f):(this._start(0,this._pauseTime,this.source.buffer.duration),this.source.loop=this._options.loop),this._playStartTime=this._manager.audioContext.currentTime,this._isPlaying=
!0,this.source.onended=function(){c._pauseTime=0;c._isPlaying=!1;if(c.isSpriteSound&&null!=b&&null!=b.loop&&b.loop&&0<=d&&-1<f)c.destroy(),c.play(c.spriteName,b);else if(null!=c._options.onend)c._options.onend(c)});return this._srcNodes.indexOf(this.source)},_start:function(a,b,c){if(null!=h.field(this.source,"start"))this.source.start(a,b,c);else if(null!=h.field(this.source,"noteGrainOn")){var d=this.source;h.field(this.source,"noteGrainOn").apply(d,[a,b,c])}else null!=h.field(this.source,"noteOn")&&
(d=this.source,h.field(this.source,"noteOn").apply(d,[a,b,c]))},togglePlay:function(a){this._isPlaying?this.pause():this.play()},isPlaying:function(a){return this._isPlaying},loop:function(a){this._options.loop=a;null!=this.source&&(this.source.loop=a)},setVolume:function(a,b){this._options.volume=a;null!=this._gainNode&&this._isLoaded&&!this._muted&&(this._gainNode.gain.value=this._options.volume)},getVolume:function(a){return this._options.volume},mute:function(a,b){this._muted=a;null!=this._gainNode&&
this._isLoaded&&(this._gainNode.gain.value=a?0:this._options.volume)},toggleMute:function(a){this.mute(!this._muted)},autoStop:function(a){this._options.autostop=a},stop:function(a){this._pauseTime=0;null!=this.source&&this._isLoaded&&this._isPlaying&&this.destroy()},pause:function(a){null!=this.source&&this._isLoaded&&this._isPlaying&&(this.destroy(),this._pauseTime+=this._manager.audioContext.currentTime-this._playStartTime)},playbackRate:function(a,b){if(null==a)return this.rate;for(var c=0,d=
this._srcNodes;c<d.length;){var e=d[c];++c;e.playbackRate.value=a}return this.rate=a},setTime:function(a){!this._isLoaded||a>this._duration||(this._isPlaying?(this.stop(),this._pauseTime=a,this.play()):this._pauseTime=a)},getTime:function(){return null!=this.source&&this._isLoaded&&this._isPlaying?this._manager.audioContext.currentTime-this._playStartTime+this._pauseTime:0},onEnd:function(a,b){this._options.onend=a;return this},onLoad:function(a){this._options.onload=a;return this},onError:function(a){this._options.onerror=
a;return this},destroy:function(){for(var a=0,b=this._srcNodes;a<b.length;){var c=b[a];++a;null!=h.field(c,"stop")?c.stop(0):null!=h.field(c,"noteOff")&&h.field(c,"noteOff").apply(c,[0]);c.disconnect()}a=0;for(b=this._gainNodes;a<b.length;)c=b[a],++a,c.disconnect();this._srcNodes=[];this._gainNodes=[];this._isPlaying=!1},__class__:C});y=function(){};y.__name__=!0;var v=function(a){var b=this;this.id=setInterval(function(){b.run()},a)};v.__name__=!0;v.delay=function(a,b){var c=new v(b);c.run=function(){c.stop();
a()};return c};v.prototype={stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},run:function(){},__class__:v};var m=function(a,b){this.map=a;this.keys=b;this.index=0;this.count=b.length};m.__name__=!0;m.prototype={hasNext:function(){return this.index<this.count},next:function(){var a=this.map,b=this.keys[this.index++];return null!=e[b]?a.getReserved(b):a.h[b]},__class__:m};var t=function(){this.h={}};t.__name__=!0;t.__interfaces__=[y];t.prototype={setReserved:function(a,b){null==
this.rh&&(this.rh={});this.rh["$"+a]=b},getReserved:function(a){return null==this.rh?null:this.rh["$"+a]},arrayKeys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(b);if(null!=this.rh)for(b in this.rh)36==b.charCodeAt(0)&&a.push(b.substr(1));return a},__class__:t};var q=function(a){Error.call(this);this.val=a;this.message=String(a);Error.captureStackTrace&&Error.captureStackTrace(this,q)};q.__name__=!0;q.wrap=function(a){return a instanceof Error?a:new q(a)};q.__super__=Error;
q.prototype=K(Error.prototype,{__class__:q});var g=function(){};g.__name__=!0;g.getClass=function(a){if(a instanceof Array&&null==a.__enum__)return Array;var b=a.__class__;if(null!=b)return b;a=g.__nativeClassName(a);return null!=a?g.__resolveNativeClass(a):null};g.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;"function"==c&&(a.__name__||a.__ename__)&&(c="object");switch(c){case "function":return"<function>";case "object":if(a instanceof Array){if(a.__enum__){if(2==
a.length)return a[0];c=a[0]+"(";b+="\t";for(var d=2,e=a.length;d<e;)var f=d++,c=2!=f?c+(","+g.__string_rec(a[f],b)):c+g.__string_rec(a[f],b);return c+")"}c=a.length;d="[";b+="\t";for(e=0;e<c;)f=e++,d+=(0<f?",":"")+g.__string_rec(a[f],b);return d+"]"}try{d=a.toString}catch(h){return"???"}if(null!=d&&d!=Object.toString&&"function"==typeof d&&(c=a.toString(),"[object Object]"!=c))return c;c=null;d="{\n";b+="\t";e=null!=a.hasOwnProperty;for(c in a)e&&!a.hasOwnProperty(c)||"prototype"==c||"__class__"==
c||"__super__"==c||"__interfaces__"==c||"__properties__"==c||(2!=d.length&&(d+=", \n"),d+=b+c+" : "+g.__string_rec(a[c],b));b=b.substring(1);return d+("\n"+b+"}");case "string":return a;default:return String(a)}};g.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;d<e;){var f=d++,f=c[f];if(f==b||g.__interfLoop(f,b))return!0}return g.__interfLoop(a.__super__,b)};g.__instanceof=function(a,b){if(null==b)return!1;switch(b){case Array:return a instanceof
Array?null==a.__enum__:!1;case M:return"boolean"==typeof a;case P:return!0;case N:return"number"==typeof a;case Q:return"number"==typeof a?(a|0)===a:!1;case String:return"string"==typeof a;default:if(null!=a)if("function"==typeof b){if(a instanceof b||g.__interfLoop(g.getClass(a),b))return!0}else{if("object"==typeof b&&g.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==R&&null!=a.__name__||b==S&&null!=a.__ename__?!0:a.__enum__==b}};g.__cast=function(a,b){if(g.__instanceof(a,b))return a;
throw new q("Cannot cast "+z.string(a)+" to "+z.string(b));};g.__nativeClassName=function(a){a=g.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?null:a};g.__isNativeObj=function(a){return null!=g.__nativeClassName(a)};g.__resolveNativeClass=function(a){return J[a]};var u=function(a){if(a instanceof Array&&null==a.__enum__)this.a=a,this.byteLength=a.length;else{this.a=[];for(var b=0;b<a;){var c=b++;this.a[c]=0}this.byteLength=a}};u.__name__=!0;u.sliceImpl=function(a,
b){var c=new L(this,a,null==b?null:b-a),d=new I(c.byteLength);(new L(d)).set(c);return d};u.prototype={slice:function(a,b){return new u(this.a.slice(a,b))},__class__:u};var A=function(){};A.__name__=!0;A._new=function(a,b,c){if("number"==typeof a){c=[];for(b=0;b<a;){var d=b++;c[d]=0}c.byteLength=c.length;c.byteOffset=0;c.buffer=new u(c)}else if(g.__instanceof(a,u))null==b&&(b=0),null==c&&(c=a.byteLength-b),c=0==b?a.a:a.a.slice(b,b+c),c.byteLength=c.length,c.byteOffset=b,c.buffer=a;else if(a instanceof
Array&&null==a.__enum__)c=a.slice(),c.byteLength=c.length,c.byteOffset=0,c.buffer=new u(c);else throw new q("TODO "+z.string(a));c.subarray=A._subarray;c.set=A._set;return c};A._set=function(a,b){if(g.__instanceof(a.buffer,u)){if(a.byteLength+b>this.byteLength)throw new q("set() outside of range");for(var c=0,d=a.byteLength;c<d;){var e=c++;this[e+b]=a[e]}}else if(a instanceof Array&&null==a.__enum__){if(a.length+b>this.byteLength)throw new q("set() outside of range");c=0;for(d=a.length;c<d;)e=c++,
this[e+b]=a[e]}else throw new q("TODO");};A._subarray=function(a,b){var c=A._new(this.slice(a,b));c.byteOffset=a;return c};var w,O=0;String.prototype.__class__=String;String.__name__=!0;Array.__name__=!0;Date.prototype.__class__=Date;Date.__name__=["Date"];var Q={__name__:["Int"]},P={__name__:["Dynamic"]},N=Number;N.__name__=["Float"];var M=Boolean;M.__ename__=["Bool"];var R={__name__:["Class"]},S={},e={},I=J.ArrayBuffer||u;null==I.prototype.slice&&(I.prototype.slice=u.sliceImpl);var L=J.Uint8Array||
A._new;d.PROBABLY="probably";d.MAYBE="maybe";d.version="0.9.7";d.useWebAudio=!0;d.defaults={autoplay:!1,autostop:!0,loop:!1,preload:!0,webaudio:!0,volume:1,playbackRate:1};d.preferredSampleRate=44100;d.isMuted=!1;d._playbackRate=1;H.JSON_PER=.8;r.FOCUS_STATE="focus";r.BLUR_STATE="blur";r.ON_FOCUS="onfocus";r.ON_BLUR="onblur";r.PAGE_SHOW="pageshow";r.PAGE_HIDE="pagehide";r.WINDOW="window";r.DOCUMENT="document";g.__toStr={}.toString;A.BYTES_PER_ELEMENT=1})("undefined"!=typeof exports?exports:"undefined"!=
typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
