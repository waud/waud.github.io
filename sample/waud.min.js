(function(w,t,J){function E(a,c){function e(){}e.prototype=a;var b=new e,A;for(A in c)b[A]=c[A];c.toString!==Object.prototype.toString&&(b.toString=c.toString);return b}function d(a,c){if(null==c)return null;null==c.__id__&&(c.__id__=K++);var e;null==a.hx__closures__?a.hx__closures__={}:e=a.hx__closures__[c.__id__];null==e&&(e=function(){return e.method.apply(e.scope,arguments)},e.scope=a,e.method=c,a.hx__closures__[c.__id__]=e);return e}var C=function(){this.bufferList=new p;this.types=new p;this.types.set("mp3",
"audio/mpeg");this.types.set("ogg","audio/ogg");this.types.set("wav","audio/wav");this.types.set("aac","audio/aac");this.types.set("m4a","audio/x-m4a")};C.__name__=!0;C.prototype={checkWebAudioAPISupport:function(){return null!=g.field(window,"AudioContext")||null!=g.field(window,"webkitAudioContext")},unlockAudio:function(){if(null!=this.audioContext){var a=this.audioContext.createBuffer(1,1,b.preferredSampleRate),c=this.audioContext.createBufferSource();c.buffer=a;c.connect(this.audioContext.destination);
null!=g.field(c,"start")?c.start(0):c.noteOn(0);null!=c.onended?c.onended=d(this,this._unlockCallback):q.delay(d(this,this._unlockCallback),1)}else a=window.document.createElement("audio"),c=window.document.createElement("source"),c.src="data:audio/wave;base64,UklGRjIAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAAABmYWN0BAAAAAAAAABkYXRhAAAAAA==",a.appendChild(c),window.document.appendChild(a),a.play(),null!=b.__touchUnlockCallback&&b.__touchUnlockCallback(),b.dom.ontouchend=null},_unlockCallback:function(){null!=
b.__touchUnlockCallback&&b.__touchUnlockCallback();b.dom.ontouchend=null},createAudioContext:function(){if(null==this.audioContext)try{null!=g.field(window,"AudioContext")?this.audioContext=new AudioContext:null!=g.field(window,"webkitAudioContext")&&(this.audioContext=new webkitAudioContext)}catch(a){a instanceof n&&(a=a.val),this.audioContext=null}return this.audioContext},destroy:function(){null!=this.audioContext&&null!=this.audioContext.close&&""!=this.audioContext.close&&this.audioContext.close();
this.types=this.bufferList=this.audioContext=null},__class__:C};var r=function(a,c){this._b64=new k("(^data:audio).*(;base64,)","i");null!=a&&""!=a&&null!=b.audioManager&&(this.isSpriteSound=!1,this.url=a,this._muted=this._isPlaying=this._isLoaded=!1,this._duration=0,this._options=l.setDefaultOptions(c),this.rate=this._options.playbackRate)};r.__name__=!0;r.prototype={isReady:function(){return this._isLoaded},__class__:r};var k=function(a,c){c=c.split("u").join("");this.r=new RegExp(a,c)};k.__name__=
!0;k.prototype={match:function(a){this.r.global&&(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m},matched:function(a){if(null!=this.r.m&&0<=a&&a<this.r.m.length)return this.r.m[a];throw new n("EReg::matched");},__class__:k};w=function(){};w.__name__=!0;w.prototype={__class__:w};var x=function(a,c,e){r.call(this,a,c);this._snd=b.dom.createElement("audio");null==e?this._addSource(a):this._snd.appendChild(e);this._options.preload&&this.load();this._b64.match(a)};x.__name__=
!0;x.__interfaces__=[w];x.__super__=r;x.prototype=E(r.prototype,{load:function(a){var c=this;this._isLoaded||(this._snd.autoplay=this._options.autoplay,this._snd.loop=this._options.loop,this._snd.volume=this._options.volume,this._snd.playbackRate=this.rate,null!=a&&(this._options.onload=a),this._snd.preload=this._options.preload?"auto":"metadata",null!=this._options.onload&&(this._isLoaded=!0,this._snd.onloadeddata=function(){c._options.onload(c)}),this._snd.onplaying=function(){c._isPlaying=!0},
this._snd.onended=function(){c._isPlaying=!1;if(null!=c._options.onend)c._options.onend(c)},null!=this._options.onerror&&(this._snd.onerror=function(){c._options.onerror(c)}),this._snd.load());return this},getDuration:function(){return this._isLoaded?this._duration=this._snd.duration:0},_addSource:function(a){this.source=b.dom.createElement("source");this.source.src=a;var c=this._getExt(a);null!=b.audioManager.types.get(c)&&(a=this._getExt(a),this.source.type=b.audioManager.types.get(a));this._snd.appendChild(this.source);
return this.source},_getExt:function(a){return a.split(".").pop()},setVolume:function(a,c){0<=a&&1>=a&&(this._options.volume=a);this._isLoaded&&(this._snd.volume=this._options.volume)},getVolume:function(a){return this._options.volume},mute:function(a,c){this._isLoaded&&(this._snd.muted=a,l.isiOS()&&(a&&this.isPlaying()?(this._muted=!0,this._snd.pause()):this._muted&&(this._muted=!1,this._snd.play())))},toggleMute:function(a){this.mute(!this._muted)},play:function(a,c){var e=this;this.spriteName=
a;if(!this._isLoaded||null==this._snd)return-1;if(this._isPlaying)if(this._options.autostop)this.stop(this.spriteName);else{var b;b=f.__cast(this._snd.cloneNode(!0),HTMLAudioElement);q.delay(d(b,b.play),100)}if(this._muted)return-1;this.isSpriteSound&&null!=c&&(this._snd.currentTime=null==this._pauseTime?c.start:this._pauseTime,null!=this._tmr&&this._tmr.stop(),this._tmr=q.delay(function(){null!=c.loop&&c.loop?e.play(e.spriteName,c):e.stop(e.spriteName)},Math.ceil(1E3*c.duration)));q.delay((z=this._snd,
d(z,z.play)),100);this._pauseTime=null;return 0},togglePlay:function(a){this._isPlaying?this.pause():this.play()},isPlaying:function(a){return this._isPlaying},loop:function(a){this._isLoaded&&null!=this._snd&&(this._snd.loop=a)},autoStop:function(a){this._options.autostop=a},stop:function(a){this._isLoaded&&null!=this._snd&&(this._snd.currentTime=0,this._snd.pause(),this._isPlaying=!1,null!=this._tmr&&this._tmr.stop())},pause:function(a){this._isLoaded&&null!=this._snd&&(this._snd.pause(),this._pauseTime=
this._snd.currentTime,this._isPlaying=!1,null!=this._tmr&&this._tmr.stop())},playbackRate:function(a,c){return null==a?this.rate:this.rate=this._snd.playbackRate=a},setTime:function(a){!this._isLoaded||null==this._snd||a>this._snd.duration||(this._snd.currentTime=a)},getTime:function(){return null!=this._snd&&this._isLoaded&&this._isPlaying?this._snd.currentTime:0},onEnd:function(a,c){this._options.onend=a;return this},onLoad:function(a){this._options.onload=a;return this},onError:function(a){this._options.onerror=
a;return this},destroy:function(){null!=this._snd&&(this._snd.pause(),this._snd.removeChild(this.source),this._snd=this.source=null);this._isPlaying=!1},__class__:x});var u=function(){};u.__name__=!0;u.cca=function(a,c){var e=a.charCodeAt(c);return e!=e?void 0:e};u.indexOf=function(a,c,e){var b=a.length;0>e&&(e+=b,0>e&&(e=0));for(;e<b;){if(a[e]===c)return e;e++}return-1};Math.__name__=!0;var g=function(){};g.__name__=!0;g.field=function(a,c){try{return a[c]}catch(e){return e instanceof n&&(e=e.val),
null}};g.fields=function(a){var c=[];if(null!=a){var e=Object.prototype.hasOwnProperty,b;for(b in a)"__id__"!=b&&"hx__closures__"!=b&&e.call(a,b)&&c.push(b)}return c};var v=function(){};v.__name__=!0;v.string=function(a){return f.__string_rec(a,"")};v.parseInt=function(a){var c=parseInt(a,10);0!=c||120!=u.cca(a,1)&&88!=u.cca(a,1)||(c=parseInt(a));return isNaN(c)?null:c};var b=t.Waud=function(){};b.__name__=!0;b.init=function(a){null==b.__audioElement&&(null==a&&(a=window.document),b.dom=a,b.__audioElement=
b.dom.createElement("audio"),null==b.audioManager&&(b.audioManager=new C),b.isWebAudioSupported=b.audioManager.checkWebAudioAPISupport(),b.isHTML5AudioSupported=null!=g.field(window,"Audio"),b.isWebAudioSupported&&(b.audioContext=b.audioManager.createAudioContext()),b.sounds=new p)};b.autoMute=function(){b._focusManager=new m;b._focusManager.focus=function(){if(!b.isMuted&&null!=b.sounds)for(var a=b.sounds.iterator();a.hasNext();)a.next().mute(!1)};b._focusManager.blur=function(){if(null!=b.sounds)for(var a=
b.sounds.iterator();a.hasNext();)a.next().mute(!0)}};b.enableTouchUnlock=function(a){b.__touchUnlockCallback=a;b.dom.ontouchend=(z=b.audioManager,d(z,z.unlockAudio))};b.mute=function(a){null==a&&(a=!0);b.isMuted=a;if(null!=b.sounds)for(var c=b.sounds.iterator();c.hasNext();)c.next().mute(a)};b.playbackRate=function(a){if(null==a)return b._playbackRate;if(null!=b.sounds)for(var c=b.sounds.iterator();c.hasNext();)c.next().playbackRate(a);return b._playbackRate=a};b.stop=function(){if(null!=b.sounds)for(var a=
b.sounds.iterator();a.hasNext();)a.next().stop()};b.pause=function(){if(null!=b.sounds)for(var a=b.sounds.iterator();a.hasNext();)a.next().pause()};b.getFormatSupportString=function(){var a="OGG: "+b.__audioElement.canPlayType('audio/ogg; codecs="vorbis"'),a=a+(", WAV: "+b.__audioElement.canPlayType('audio/wav; codecs="1"')),a=a+(", MP3: "+b.__audioElement.canPlayType("audio/mpeg;")),a=a+(", AAC: "+b.__audioElement.canPlayType("audio/aac;"));return a+=", M4A: "+b.__audioElement.canPlayType("audio/x-m4a;")};
b.isSupported=function(){if(null==b.isWebAudioSupported||null==b.isHTML5AudioSupported)b.isWebAudioSupported=b.audioManager.checkWebAudioAPISupport(),b.isHTML5AudioSupported=null!=g.field(window,"Audio");return b.isWebAudioSupported||b.isHTML5AudioSupported};b.isOGGSupported=function(){var a=b.__audioElement.canPlayType('audio/ogg; codecs="vorbis"');return b.isHTML5AudioSupported&&null!=a&&("probably"==a||"maybe"==a)};b.isWAVSupported=function(){var a=b.__audioElement.canPlayType('audio/wav; codecs="1"');
return b.isHTML5AudioSupported&&null!=a&&("probably"==a||"maybe"==a)};b.isMP3Supported=function(){var a=b.__audioElement.canPlayType("audio/mpeg;");return b.isHTML5AudioSupported&&null!=a&&("probably"==a||"maybe"==a)};b.isAACSupported=function(){var a=b.__audioElement.canPlayType("audio/aac;");return b.isHTML5AudioSupported&&null!=a&&("probably"==a||"maybe"==a)};b.isM4ASupported=function(){var a=b.__audioElement.canPlayType("audio/x-m4a;");return b.isHTML5AudioSupported&&null!=a&&("probably"==a||
"maybe"==a)};b.get_sampleRate=function(){return null!=b.audioContext?b.audioContext.sampleRate:0};b.destroy=function(){if(null!=b.sounds)for(var a=b.sounds.iterator();a.hasNext();)a.next().destroy();b.sounds=null;null!=b.audioManager&&b.audioManager.destroy();b.audioManager=null;b.audioContext=null;b.__audioElement=null;null!=b._focusManager&&(b._focusManager.clearEvents(),b._focusManager.blur=null,b._focusManager.focus=null,b._focusManager=null)};var F=t.WaudBase64Pack=function(a,c,e,h,A){null!=
b.audioManager&&0<a.indexOf(".json")&&(this.progress=0,this._options=l.setDefaultOptions(A),this._loadCount=this._soundCount=this._totalSize=0,this._onLoaded=c,this._onProgress=e,this._onError=h,this._sounds=new p,this._loadBase64Json(a))};F.__name__=!0;F.prototype={_loadBase64Json:function(a){var c=this,e=new k('"meta":.[0-9]*,[0-9]*.',"i"),b=new XMLHttpRequest;b.open("GET",a,!0);null!=this._onProgress&&(b.onprogress=function(a){if(e.match(b.responseText)&&0==c._totalSize){var d=JSON.parse("{"+e.matched(0)+
"}");c._totalSize=d.meta[1]}c.progress=a.lengthComputable?a.loaded/a.total:a.loaded/c._totalSize;1<c.progress&&(c.progress=1);c._onProgress(c.progress,a.loaded)});b.onreadystatechange=function(){if(4==b.readyState&&200==b.status)for(var a=JSON.parse(b.responseText),e=0,d=g.fields(a);e<d.length;){var f=d[e];++e;"meta"!=f&&(c._soundCount++,a instanceof Array&&null==a.__enum__?c._createSound(g.field(a,f).name,"data:"+v.string(g.field(a,f).mime)+";base64,"+v.string(g.field(a,f).data)):c._createSound(f,
g.field(a,f)))}};b.send(null)},_createSound:function(a,c){var e=this;new B(c,{onload:function(c){e._sounds.set(a,c);b.sounds.set(a,c);if(null!=e._options.onload)e._options.onload(c);e._checkProgress()},onerror:function(c){e._sounds.set(a,null);if(null!=e._options.onerror)e._options.onerror(c);e._checkProgress()&&null!=e._onError&&e._onError()},autoplay:this._options.autoplay,autostop:this._options.autostop,loop:this._options.loop,onend:this._options.onend,playbackRate:this._options.playbackRate,preload:this._options.preload,
volume:this._options.volume,webaudio:this._options.webaudio})},_checkProgress:function(){this._loadCount++;return this._loadCount==this._soundCount?(null!=this._onLoaded&&this._onLoaded(this._sounds),0==this.progress&&null!=this._onProgress&&(this.progress=1,this._onProgress(this.progress,this._totalSize)),!0):!1},__class__:F};var m=t.WaudFocusManager=function(){var a=this;this._currentState=this._visibilityChange=this._hidden="";null!=g.field(window.document,"hidden")?(this._hidden="hidden",this._visibilityChange=
"visibilitychange"):null!=g.field(window.document,"mozHidden")?(this._hidden="mozHidden",this._visibilityChange="mozvisibilitychange"):null!=g.field(window.document,"msHidden")?(this._hidden="msHidden",this._visibilityChange="msvisibilitychange"):null!=g.field(window.document,"webkitHidden")&&(this._hidden="webkitHidden",this._visibilityChange="webkitvisibilitychange");null!=g.field(window,"addEventListener")?(window.addEventListener("focus",d(this,this._focus)),window.addEventListener("blur",d(this,
this._blur)),window.addEventListener("pageshow",d(this,this._focus)),window.addEventListener("pagehide",d(this,this._blur)),document.addEventListener(this._visibilityChange,d(this,this._handleVisibilityChange))):null!=g.field(window,"attachEvent")?(window.attachEvent("onfocus",d(this,this._focus)),window.attachEvent("onblur",d(this,this._blur)),window.attachEvent("pageshow",d(this,this._focus)),window.attachEvent("pagehide",d(this,this._blur)),document.attachEvent(this._visibilityChange,d(this,this._handleVisibilityChange))):
window.onload=function(){window.onfocus=d(a,a._focus);window.onblur=d(a,a._blur);window.onpageshow=d(a,a._focus);window.onpagehide=d(a,a._blur)}};m.__name__=!0;m.prototype={_handleVisibilityChange:function(){null!=g.field(window.document,this._hidden)&&g.field(window.document,this._hidden)&&null!=this.blur?this.blur():null!=this.focus&&this.focus()},_focus:function(){"focus"!=this._currentState&&null!=this.focus&&this.focus();this._currentState="focus"},_blur:function(){"blur"!=this._currentState&&
null!=this.blur&&this.blur();this._currentState="blur"},clearEvents:function(){null!=g.field(window,"removeEventListener")?(window.removeEventListener("focus",d(this,this._focus)),window.removeEventListener("blur",d(this,this._blur)),window.removeEventListener("pageshow",d(this,this._focus)),window.removeEventListener("pagehide",d(this,this._blur)),window.removeEventListener(this._visibilityChange,d(this,this._handleVisibilityChange))):null!=g.field(window,"removeEvent")?(window.removeEvent("onfocus",
d(this,this._focus)),window.removeEvent("onblur",d(this,this._blur)),window.removeEvent("pageshow",d(this,this._focus)),window.removeEvent("pagehide",d(this,this._blur)),window.removeEvent(this._visibilityChange,d(this,this._handleVisibilityChange))):(window.onfocus=null,window.onblur=null,window.onpageshow=null,window.onpagehide=null)},__class__:m};var B=t.WaudSound=function(a,c){if(null!=b.audioManager)if(this.rate=1,this._options=c,0<a.indexOf(".json")?(this.isSpriteSound=!0,this._spriteDuration=
0,this._spriteSounds=new p,this._spriteSoundEndCallbacks=new p,this._loadSpriteJson(a)):(this.isSpriteSound=!1,this._init(a)),(new k("(^data:audio).*(;base64,)","i")).match(a)){var e="snd"+(new Date).getTime();b.sounds.set(e,this)}else b.sounds.set(a,this)};B.__name__=!0;B.__interfaces__=[w];B.prototype={_loadSpriteJson:function(a){var c=this,b=new XMLHttpRequest;b.open("GET",a,!0);b.onreadystatechange=function(){if(4==b.readyState&&200==b.status){c._spriteData=JSON.parse(b.responseText);var h=c._spriteData.src;
-1<a.indexOf("/")&&(h=a.substring(0,a.lastIndexOf("/")+1)+h);c._init(h)}};b.send(null)},_init:function(a){this.url=a;if(b.isWebAudioSupported&&b.useWebAudio&&(null==this._options||null==this._options.webaudio||this._options.webaudio))this.isSpriteSound?this._loadSpriteSound(this.url):this._snd=new y(this.url,this._options);else if(b.isHTML5AudioSupported)if(null!=this._spriteData&&null!=this._spriteData.sprite){a=0;for(var c=this._spriteData.sprite;a<c.length;){var e=c[a];++a;var h=new x(this.url,
this._options);h.isSpriteSound=!0;this._spriteSounds.set(e.name,h)}}else this._snd=new x(this.url,this._options)},getDuration:function(){return this.isSpriteSound?this._spriteDuration:null==this._snd?0:this._snd.getDuration()},setVolume:function(a,c){this.isSpriteSound?null!=c&&null!=this._spriteSounds.get(c)&&this._spriteSounds.get(c).setVolume(a):null!=this._snd&&this._snd.setVolume(a)},getVolume:function(a){return this.isSpriteSound?null!=a&&null!=this._spriteSounds.get(a)?this._spriteSounds.get(a).getVolume():
0:null==this._snd?0:this._snd.getVolume()},mute:function(a,c){if(this.isSpriteSound)if(null!=c&&null!=this._spriteSounds.get(c))this._spriteSounds.get(c).mute(a);else for(var b=this._spriteSounds.iterator();b.hasNext();)b.next().mute(a);else null!=this._snd&&this._snd.mute(a)},toggleMute:function(a){if(this.isSpriteSound)if(null!=a&&null!=this._spriteSounds.get(a))this._spriteSounds.get(a).toggleMute();else for(a=this._spriteSounds.iterator();a.hasNext();)a.next().toggleMute();else null!=this._snd&&
this._snd.toggleMute()},load:function(a){if(null==this._snd||this.isSpriteSound)return null;this._snd.load(a);return this},isReady:function(){if(this.isSpriteSound)for(var a=this._spriteSounds.iterator();a.hasNext();)return a.next().isReady();return this._snd.isReady()},play:function(a,c){if(this.isSpriteSound)if(null!=a){for(var b=0,h=this._spriteData.sprite;b<h.length;){var d=h[b];++b;if(d.name==a){c=d;break}}if(null==c)return null;if(null!=this._spriteSounds.get(a))return this._spriteSounds.get(a).stop(),
this._spriteSounds.get(a).play(a,c)}else return null;return null==this._snd?null:this._snd.play(a,c)},togglePlay:function(a){this.isSpriteSound?null!=a&&null!=this._spriteSounds.get(a)&&this._spriteSounds.get(a).togglePlay():null!=this._snd&&this._snd.togglePlay()},isPlaying:function(a){return this.isSpriteSound?null!=a&&null!=this._spriteSounds.get(a)?this._spriteSounds.get(a).isPlaying():!1:null==this._snd?!1:this._snd.isPlaying()},loop:function(a){null==this._snd||this.isSpriteSound||this._snd.loop(a)},
autoStop:function(a){null!=this._snd&&this._snd.autoStop(a)},stop:function(a){if(this.isSpriteSound)if(null!=a&&null!=this._spriteSounds.get(a))this._spriteSounds.get(a).stop();else for(a=this._spriteSounds.iterator();a.hasNext();)a.next().stop();else null!=this._snd&&this._snd.stop()},pause:function(a){if(this.isSpriteSound)if(null!=a&&null!=this._spriteSounds.get(a))this._spriteSounds.get(a).pause();else for(a=this._spriteSounds.iterator();a.hasNext();)a.next().pause();else null!=this._snd&&this._snd.pause()},
playbackRate:function(a,c){if(null!=a){if(this.isSpriteSound)if(null!=c&&null!=this._spriteSounds.get(c))this._spriteSounds.get(c).playbackRate(a);else for(var b=this._spriteSounds.iterator();b.hasNext();)b.next().playbackRate(a);else null!=this._snd&&this._snd.playbackRate(a);return this.rate=a}return this.rate},setTime:function(a){null==this._snd||this.isSpriteSound||this._snd.setTime(a)},getTime:function(){return null==this._snd||this.isSpriteSound?0:this._snd.getTime()},onEnd:function(a,c){return this.isSpriteSound?
(null!=c&&this._spriteSoundEndCallbacks.set(c,a),this):null!=this._snd?(this._snd.onEnd(a),this):null},onLoad:function(a){if(null==this._snd||this.isSpriteSound)return null;this._snd.onLoad(a);return this},onError:function(a){if(null==this._snd||this.isSpriteSound)return null;this._snd.onError(a);return this},destroy:function(){if(this.isSpriteSound)for(var a=this._spriteSounds.iterator();a.hasNext();)a.next().destroy();else null!=this._snd&&(this._snd.destroy(),this._snd=null)},_loadSpriteSound:function(a){var c=
new XMLHttpRequest;c.open("GET",a,!0);c.responseType="arraybuffer";c.onload=d(this,this._onSpriteSoundLoaded);c.onerror=d(this,this._onSpriteSoundError);c.send()},_onSpriteSoundLoaded:function(a){b.audioManager.audioContext.decodeAudioData(a.target.response,d(this,this._decodeSuccess),d(this,this._onSpriteSoundError))},_onSpriteSoundError:function(){if(null!=this._options&&null!=this._options.onerror)this._options.onerror(this)},_decodeSuccess:function(a){if(null==a)this._onSpriteSoundError();else{b.audioManager.bufferList.set(this.url,
a);this._spriteDuration=a.duration;if(null!=this._options&&null!=this._options.onload)this._options.onload(this);for(var c=0,e=this._spriteData.sprite;c<e.length;){var h=e[c];++c;var f=new y(this.url,this._options,!0,a.duration);f.isSpriteSound=!0;this._spriteSounds.set(h.name,f);f.onEnd(d(this,this._spriteOnEnd),h.name)}}},_spriteOnEnd:function(a){null!=this._spriteSoundEndCallbacks.get(a.spriteName)&&this._spriteSoundEndCallbacks.get(a.spriteName)(a)},__class__:B};var l=t.WaudUtils=function(){};
l.__name__=!0;l.isAndroid=function(a){null==a&&(a=window.navigator.userAgent);return(new k("Android","i")).match(a)};l.isiOS=function(a){null==a&&(a=window.navigator.userAgent);return(new k("(iPad|iPhone|iPod)","i")).match(a)};l.isWindowsPhone=function(a){null==a&&(a=window.navigator.userAgent);return(new k("(IEMobile|Windows Phone)","i")).match(a)};l.isFirefox=function(a){null==a&&(a=window.navigator.userAgent);return(new k("Firefox","i")).match(a)};l.isOpera=function(a){null==a&&(a=window.navigator.userAgent);
return(new k("Opera","i")).match(a)||null!=g.field(window,"opera")};l.isChrome=function(a){null==a&&(a=window.navigator.userAgent);return(new k("Chrome","i")).match(a)};l.isSafari=function(a){null==a&&(a=window.navigator.userAgent);return(new k("Safari","i")).match(a)};l.isMobile=function(a){null==a&&(a=window.navigator.userAgent);return(new k("(iPad|iPhone|iPod|Android|webOS|BlackBerry|Windows Phone|IEMobile)","i")).match(a)};l.getiOSVersion=function(a){null==a&&(a=window.navigator.userAgent);var c=
new k("[0-9_]+?[0-9_]+?[0-9_]+","i"),b=[];if(c.match(a)){a=c.matched(0).split("_");c=[];for(b=0;b<a.length;){var h=a[b];++b;c.push(v.parseInt(h))}b=c}return b};l.setDefaultOptions=function(a){null==a&&(a={});a.autoplay=null!=a.autoplay?a.autoplay:b.defaults.autoplay;a.autostop=null!=a.autostop?a.autostop:b.defaults.autostop;a.webaudio=null!=a.webaudio?a.webaudio:b.defaults.webaudio;a.preload=null!=a.preload?a.preload:b.defaults.preload;a.loop=null!=a.loop?a.loop:b.defaults.loop;a.onload=null!=a.onload?
a.onload:b.defaults.onload;a.onend=null!=a.onend?a.onend:b.defaults.onend;a.onerror=null!=a.onerror?a.onerror:b.defaults.onerror;if(null==a.volume||0>a.volume||1<a.volume)a.volume=b.defaults.volume;if(null==a.playbackRate||0>=a.playbackRate||4<=a.playbackRate)a.playbackRate=b.defaults.playbackRate;return a};var y=function(a,c,e,h){null==h&&(h=0);null==e&&(e=!1);r.call(this,a,c);this._pauseTime=this._playStartTime=0;this._srcNodes=[];this._gainNodes=[];this._currentSoundProps=null;this._isLoaded=e;
this._duration=h;this._manager=b.audioManager;this._b64.match(a)?this._decodeAudio(this._base64ToArrayBuffer(a)):this._options.preload&&!e&&this.load()};y.__name__=!0;y.__interfaces__=[w];y.__super__=r;y.prototype=E(r.prototype,{load:function(a){if(!this._isLoaded){var c=new XMLHttpRequest;c.open("GET",this.url,!0);c.responseType="arraybuffer";c.onload=d(this,this._onSoundLoaded);c.onerror=d(this,this._error);c.send();null!=a&&(this._options.onload=a)}return this},_base64ToArrayBuffer:function(a){a=
window.atob(a.split(",")[1]);for(var c=a.length,b=new Uint8Array(new ArrayBuffer(c)),h=0;h<c;){var d=h++;b[d]=u.cca(a,d)}return b.buffer},_onSoundLoaded:function(a){this._manager.audioContext.decodeAudioData(a.target.response,d(this,this._decodeSuccess),d(this,this._error))},_decodeAudio:function(a){this._manager.audioContext.decodeAudioData(a,d(this,this._decodeSuccess),d(this,this._error))},_error:function(){if(null!=this._options.onerror)this._options.onerror(this)},_decodeSuccess:function(a){if(null==
a)this._error();else{this._manager.bufferList.set(this.url,a);this._isLoaded=!0;this._duration=a.duration;if(null!=this._options.onload)this._options.onload(this);this._options.autoplay&&this.play()}},_makeSource:function(a){var c=this._manager.audioContext.createBufferSource();c.buffer=a;this._gainNode=null!=this._manager.audioContext.createGain?this._manager.audioContext.createGain():this._manager.audioContext.createGainNode();c.connect(this._gainNode);c.playbackRate.value=this.rate;this._gainNode.connect(this._manager.audioContext.destination);
this._srcNodes.push(c);this._gainNodes.push(this._gainNode);this._gainNode.gain.value=this._muted?0:this._options.volume;return c},getDuration:function(){return this._isLoaded?this._duration:0},play:function(a,c){var b=this;this.spriteName=a;this._isPlaying&&this._options.autostop&&this.stop(this.spriteName);if(!this._isLoaded)return-1;var h=0,d=-1;this.isSpriteSound&&null!=c&&(this._currentSoundProps=c,h=c.start+this._pauseTime,d=c.duration);var f;f=null!=this._manager.bufferList?this._manager.bufferList.get(this.url):
null;null!=f&&(this.source=this._makeSource(f),0<=h&&-1<d?null!=g.field(this.source,"start")?this.source.start(0,h,d):this._snd.noteGrainOn(0,h,d):(null!=g.field(this.source,"start")?this.source.start(0,this._pauseTime,this.source.buffer.duration):this._snd.noteGrainOn(0,this._pauseTime,this.source.buffer.duration),this.source.loop=this._options.loop),this._playStartTime=this._manager.audioContext.currentTime,this._isPlaying=!0,this.source.onended=function(){b._pauseTime=0;b._isPlaying=!1;if(b.isSpriteSound&&
null!=c&&null!=c.loop&&c.loop&&0<=h&&-1<d)b.destroy(),b.play(b.spriteName,c);else if(null!=b._options.onend)b._options.onend(b)});return u.indexOf(this._srcNodes,this.source,0)},togglePlay:function(a){this._isPlaying?this.pause():this.play()},isPlaying:function(a){return this._isPlaying},loop:function(a){this._options.loop=a;null!=this.source&&(this.source.loop=a)},setVolume:function(a,c){this._options.volume=a;null!=this._gainNode&&this._isLoaded&&(this._gainNode.gain.value=this._options.volume)},
getVolume:function(a){return this._options.volume},mute:function(a,c){this._muted=a;null!=this._gainNode&&this._isLoaded&&(this._gainNode.gain.value=a?0:this._options.volume)},toggleMute:function(a){this.mute(!this._muted)},autoStop:function(a){this._options.autostop=a},stop:function(a){this._pauseTime=0;null!=this.source&&this._isLoaded&&this._isPlaying&&this.destroy()},pause:function(a){null!=this.source&&this._isLoaded&&this._isPlaying&&(this.destroy(),this._pauseTime+=this._manager.audioContext.currentTime-
this._playStartTime)},playbackRate:function(a,c){if(null==a)return this.rate;for(var b=0,d=this._srcNodes;b<d.length;){var f=d[b];++b;f.playbackRate.value=a}return this.rate=a},setTime:function(a){!this._isLoaded||a>this._duration||(this._isPlaying?(this.stop(),this._pauseTime=a,this.play()):this._pauseTime=a)},getTime:function(){return null!=this.source&&this._isLoaded&&this._isPlaying?this._manager.audioContext.currentTime-this._playStartTime+this._pauseTime:0},onEnd:function(a,c){this._options.onend=
a;return this},onLoad:function(a){this._options.onload=a;return this},onError:function(a){this._options.onerror=a;return this},destroy:function(){for(var a=0,c=this._srcNodes;a<c.length;){var b=c[a];++a;if(null!=g.field(b,"stop"))b.stop(0);else if(null!=g.field(b,"noteOff"))try{this.src.noteOff(0)}catch(d){d instanceof n&&(d=d.val)}b.disconnect()}a=0;for(c=this._gainNodes;a<c.length;)b=c[a],++a,b.disconnect();this._srcNodes=[];this._gainNodes=[];this._isPlaying=!1},__class__:y});t=function(){};t.__name__=
!0;var q=function(a){var c=this;this.id=setInterval(function(){c.run()},a)};q.__name__=!0;q.delay=function(a,c){var b=new q(c);b.run=function(){b.stop();a()};return b};q.prototype={stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},run:function(){},__class__:q};var D=function(a,c){this.map=a;this.keys=c;this.index=0;this.count=c.length};D.__name__=!0;D.prototype={hasNext:function(){return this.index<this.count},next:function(){return this.map.get(this.keys[this.index++])},__class__:D};
var p=function(){this.h={}};p.__name__=!0;p.__interfaces__=[t];p.prototype={set:function(a,c){null!=G[a]?this.setReserved(a,c):this.h[a]=c},get:function(a){return null!=G[a]?this.getReserved(a):this.h[a]},setReserved:function(a,c){null==this.rh&&(this.rh={});this.rh["$"+a]=c},getReserved:function(a){return null==this.rh?null:this.rh["$"+a]},arrayKeys:function(){var a=[],c;for(c in this.h)this.h.hasOwnProperty(c)&&a.push(c);if(null!=this.rh)for(c in this.rh)36==c.charCodeAt(0)&&a.push(c.substr(1));
return a},iterator:function(){return new D(this,this.arrayKeys())},__class__:p};var n=function(a){Error.call(this);this.val=a;this.message=String(a);Error.captureStackTrace&&Error.captureStackTrace(this,n)};n.__name__=!0;n.__super__=Error;n.prototype=E(Error.prototype,{__class__:n});var f=function(){};f.__name__=!0;f.getClass=function(a){if(a instanceof Array&&null==a.__enum__)return Array;var c=a.__class__;if(null!=c)return c;a=f.__nativeClassName(a);return null!=a?f.__resolveNativeClass(a):null};
f.__string_rec=function(a,c){if(null==a)return"null";if(5<=c.length)return"<...>";var b=typeof a;"function"==b&&(a.__name__||a.__ename__)&&(b="object");switch(b){case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];b=a[0]+"(";c+="\t";for(var d=2,g=a.length;d<g;)var k=d++,b=2!=k?b+(","+f.__string_rec(a[k],c)):b+f.__string_rec(a[k],c);return b+")"}b=a.length;d="[";c+="\t";for(g=0;g<b;)k=g++,d+=(0<k?",":"")+f.__string_rec(a[k],c);return d+"]"}try{d=a.toString}catch(l){return l instanceof
n&&(l=l.val),"???"}if(null!=d&&d!=Object.toString&&"function"==typeof d&&(b=a.toString(),"[object Object]"!=b))return b;b=null;d="{\n";c+="\t";g=null!=a.hasOwnProperty;for(b in a)g&&!a.hasOwnProperty(b)||"prototype"==b||"__class__"==b||"__super__"==b||"__interfaces__"==b||"__properties__"==b||(2!=d.length&&(d+=", \n"),d+=c+b+" : "+f.__string_rec(a[b],c));c=c.substring(1);return d+("\n"+c+"}");case "function":return"<function>";case "string":return a;default:return String(a)}};f.__interfLoop=function(a,
c){if(null==a)return!1;if(a==c)return!0;var b=a.__interfaces__;if(null!=b)for(var d=0,g=b.length;d<g;){var k=d++,k=b[k];if(k==c||f.__interfLoop(k,c))return!0}return f.__interfLoop(a.__super__,c)};f.__instanceof=function(a,b){if(null==b)return!1;switch(b){case L:return(a|0)===a;case H:return"number"==typeof a;case I:return"boolean"==typeof a;case String:return"string"==typeof a;case Array:return a instanceof Array&&null==a.__enum__;case M:return!0;default:if(null!=a)if("function"==typeof b){if(a instanceof
b||f.__interfLoop(f.getClass(a),b))return!0}else{if("object"==typeof b&&f.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==N&&null!=a.__name__||b==O&&null!=a.__ename__?!0:a.__enum__==b}};f.__cast=function(a,b){if(f.__instanceof(a,b))return a;throw new n("Cannot cast "+v.string(a)+" to "+v.string(b));};f.__nativeClassName=function(a){a=f.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?null:a};f.__isNativeObj=function(a){return null!=f.__nativeClassName(a)};
f.__resolveNativeClass=function(a){return J[a]};var z,K=0;Array.prototype.indexOf&&(u.indexOf=function(a,b,d){return Array.prototype.indexOf.call(a,b,d)});String.prototype.__class__=String;String.__name__=!0;Array.__name__=!0;Date.prototype.__class__=Date;Date.__name__=["Date"];var L={__name__:["Int"]},M={__name__:["Dynamic"]},H=Number;H.__name__=["Float"];var I=Boolean;I.__ename__=["Bool"];var N={__name__:["Class"]},O={},G={};b.PROBABLY="probably";b.MAYBE="maybe";b.version="0.7.9";b.useWebAudio=
!0;b.defaults={autoplay:!1,autostop:!0,loop:!1,preload:!0,webaudio:!0,volume:1,playbackRate:1};b.preferredSampleRate=44100;b.isMuted=!1;b._playbackRate=1;m.FOCUS_STATE="focus";m.BLUR_STATE="blur";m.ON_FOCUS="onfocus";m.ON_BLUR="onblur";m.PAGE_SHOW="pageshow";m.PAGE_HIDE="pagehide";m.WINDOW="window";m.DOCUMENT="document";f.__toStr={}.toString})("undefined"!=typeof console?console:{log:function(){}},"undefined"!=typeof window?window:exports,"undefined"!=typeof window?window:"undefined"!=typeof global?
global:"undefined"!=typeof self?self:this);
